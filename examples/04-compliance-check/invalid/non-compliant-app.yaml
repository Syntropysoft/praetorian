# Non-Compliant Application Configuration - Compliance Check Example
app:
  name: "non-compliant-application"
  version: "1.0.0"
  environment: "production"
  # ❌ Error: Missing required fields for compliance
  # description: "Application description"
  # maintainer: "security@company.com"
  # license: "MIT"

# Database Configuration - Non-Compliant
database:
  host: "prod-db.example.com"
  port: 5432
  name: "non_compliant_app_prod"
  credentials:
    username: "admin"  # ❌ Error: Using admin user
    password: "hardcoded_password_123"  # ❌ Error: Hardcoded secret
    ssl: false  # ❌ Error: SSL disabled for compliance
    sslMode: "disable"  # ❌ Error: SSL mode disabled
    # ❌ Error: Missing timeout configurations
    # connectionTimeout: 30000
    # idleTimeout: 30000
  
  # ❌ Error: Missing backup configuration
  # backup:
  #   enabled: true
  #   schedule: "0 2 * * *"
  #   retention: "30d"
  #   encryption: true

# Security Configuration - Non-Compliant
security:
  cors:
    origin: "*"  # ❌ Error: Wildcard CORS - non-compliant
    credentials: true
    methods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
    allowedHeaders: ["*"]  # ❌ Error: Wildcard headers - non-compliant
    # ❌ Error: Missing maxAge configuration
  
  headers:
    x-frame-options: "SAMEORIGIN"  # ❌ Error: Should be DENY for compliance
    # ❌ Error: Missing critical security headers for compliance
    # x-content-type-options: "nosniff"
    # x-xss-protection: "1; mode=block"
    # strict-transport-security: "max-age=31536000; includeSubDomains; preload"
    # content-security-policy: "default-src 'self'"
    # referrer-policy: "strict-origin-when-cross-origin"
  
  authentication:
    jwt:
      secret: "hardcoded_jwt_secret_key"  # ❌ Error: Hardcoded JWT secret
      expiresIn: "24h"  # ❌ Error: Too long expiration for compliance
      refreshExpiresIn: "30d"  # ❌ Error: Too long refresh expiration
      issuer: "non-compliant-app"
      audience: "*"  # ❌ Error: Wildcard audience - non-compliant
    
    bcrypt:
      rounds: 8  # ❌ Error: Too few rounds for compliance (should be 12+)
    
    rateLimit:
      windowMs: 900000
      max: 1000  # ❌ Error: Too high rate limit for compliance
      message: "Too many requests"
  
  encryption:
    algorithm: "aes-128-ecb"  # ❌ Error: Weak encryption algorithm for compliance
    key: "hardcoded_encryption_key"  # ❌ Error: Hardcoded encryption key

# Logging Configuration - Non-Compliant
logging:
  level: "debug"  # ❌ Error: Debug level in production - non-compliant
  format: "text"  # ❌ Error: Should be JSON for compliance
  output: "console"  # ❌ Error: Console output in production - non-compliant
  file:
    filename: "./app.log"  # ❌ Error: Relative path and no rotation
    maxsize: "1MB"  # ❌ Error: Too small for compliance
    maxFiles: 1  # ❌ Error: No log rotation - non-compliant
    # ❌ Error: Missing compression configuration
  
  # ❌ Error: Missing audit logging for compliance
  # audit:
  #   enabled: true
  #   level: "info"
  #   events: ["auth", "access", "data_access", "admin_actions"]
  #   retention: "7y"

# Monitoring Configuration - Non-Compliant
monitoring:
  enabled: true
  metrics:
    enabled: true
    port: 9090
    path: "/metrics"
    auth: false  # ❌ Error: No authentication for metrics - non-compliant
    username: "admin"  # ❌ Error: Hardcoded username
    password: "metrics_password"  # ❌ Error: Hardcoded password
  
  health:
    enabled: true
    path: "/health"
    auth: false  # ❌ Error: No authentication for health checks - non-compliant
    # ❌ Error: Missing health checks configuration
    # checks: ["database", "redis", "external_apis"]

# ❌ Error: Missing compliance configuration
# compliance:
#   gdpr:
#     enabled: true
#     dataRetention: "7y"
#     dataEncryption: true
#     userConsent: true
#     dataPortability: true
#   
#   soc2:
#     enabled: true
#     controls: ["CC1", "CC2", "CC3", "CC4", "CC5", "CC6", "CC7", "CC8", "CC9"]
#     monitoring: true
#     reporting: true
#   
#   iso27001:
#     enabled: true
#     controls: ["A.5", "A.6", "A.7", "A.8", "A.9", "A.10", "A.11", "A.12", "A.13", "A.14", "A.15", "A.16", "A.17", "A.18"]
#     riskAssessment: true
#     incidentManagement: true 